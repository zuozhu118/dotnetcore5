(function () {
  "use strict";

  var global = tinymce.util.Tools.resolve("tinymce.PluginManager");
  var iconManager = tinymce.util.Tools.resolve("tinymce.IconManager");

  //   var global$1 = tinymce.util.Tools.resolve("tinymce.util.Tools");

  //   var global$2 = tinymce.util.Tools.resolve("tinymce.html.DomParser");

  //   var global$3 = tinymce.util.Tools.resolve("tinymce.html.Node");

  //   var global$4 = tinymce.util.Tools.resolve("tinymce.html.Serializer");

  //   var register = function (editor, headState) {
  //     editor.addCommand("mceFullPageProperties", function () {
  //       open(editor, headState);
  //     });
  //   };

  //   var setup = function (editor, headState, footState) {
  //     editor.on("BeforeSetContent", function (evt) {
  //       handleSetContent(editor, headState, footState, evt);
  //     });
  //     editor.on("GetContent", function (evt) {
  //       handleGetContent(editor, headState.get(), footState.get(), evt);
  //     });
  //   };

  // var makeDialogBody = function (info) {
  //   if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {
  //     var tabPanel = {
  //       type: "tabpanel",
  //       tabs: flatten([
  //         [MainTab.makeTab(info)],
  //         info.hasAdvTab ? [AdvTab.makeTab(info)] : [],
  //         info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler)
  //           ? [UploadTab.makeTab(info)]
  //           : [],
  //       ]),
  //     };
  //     return tabPanel;
  //   } else {
  //     var panel = {
  //       type: "panel",
  //       items: MainTab.makeItems(info),
  //     };
  //     return panel;
  //   }
  // };

  // var makeDialog = function (helpers) {
  //   return function (info) {
  //     var state = createState(info);
  //     return {
  //       title: "配置数据源",
  //       size: "normal",
  //       body: makeDialogBody(info),
  //       buttons: [
  //         {
  //           type: "cancel",
  //           name: "cancel",
  //           text: "取消",
  //         },
  //         {
  //           type: "submit",
  //           name: "save",
  //           text: "保存",
  //           primary: true,
  //         },
  //       ],
  //       initialData: fromImageData(info.image),
  //       onSubmit: helpers.onSubmit(info),
  //       onChange: changeHandler(helpers, info, state),
  //       onClose: closeHandler(state),
  //     };
  //   };
  // };

  function registerIcons(editor) {
    const defaultIcons = iconManager.get("default").icons;
    defaultIcons["form-text"] =
      '<svg width="24" height="24"><path d="M853.333333 298.666667v426.666666H170.666667V298.666667h682.666666m0-85.333334H170.666667a85.333333 85.333333 0 0 0-85.333334 85.333334v426.666666a85.333333 85.333333 0 0 0 85.333334 85.333334h682.666666a85.333333 85.333333 0 0 0 85.333334-85.333334V298.666667a85.333333 85.333333 0 0 0-85.333334-85.333334z" p-id="1183"></path><path d="M256 384h42.666667v256H256zM213.333333 341.333333h128v42.666667H213.333333zM213.333333 640h128v42.666667H213.333333z" p-id="1184"></path></svg>';
    defaultIcons["form-textarea"] =
      '<svg width="24" height="24"><path d="M29.866667 85.333333v853.333334h968.533333V85.333333H29.866667z m883.2 597.333334L768 827.733333H110.933333V196.266667h802.133334V682.666667z" p-id="1985"></path><path d="M196.266667 337.066667c8.533333-29.866667 8.533333-29.866667 42.666666-29.866667V469.333333h-38.4v46.933334h136.533334V469.333333H298.666667V307.2h12.8c21.333333 0 25.6 0 29.866666 29.866667v17.066666l42.666667-8.533333v-25.6c0-17.066667-4.266667-38.4 0-51.2v-21.333333h-38.4L341.333333 256H196.266667l-4.266667-8.533333h-38.4v21.333333c0 17.066667 0 38.4-4.266667 59.733333v21.333334h42.666667l4.266667-12.8z m473.6 409.6l179.2-179.2 29.866666 29.866666-179.2 179.2-29.866666-29.866666z" p-id="1986"></path></svg>';
    defaultIcons["form-radio"] =
      '<svg width="24" height="24"><path d="M512 304c-114.4 0-208 93.6-208 208s93.6 208 208 208 208-93.6 208-208-93.6-208-208-208z m0-208C283.202 96 96 283.202 96 512s187.202 416 416 416 416-187.202 416-416S740.798 96 512 96z m0 748.8c-183.036 0-332.8-149.766-332.8-332.8S328.964 179.2 512 179.2 844.8 328.964 844.8 512 695.036 844.8 512 844.8z" fill="#8A8A8A" p-id="2783"></path></svg>';
    defaultIcons["form-checkbox"] =
      '<svg width="24" height="24"><path d="M467.106909 581.073455l-107.636364-108.311273a55.645091 55.645091 0 1 0-78.94109 78.475636l148.154181 149.085091a55.458909 55.458909 0 0 0 40.680728 16.663273 55.389091 55.389091 0 0 0 39.982545-17.966546l278.039273-298.426181a55.645091 55.645091 0 1 0-81.454546-75.869091L467.130182 581.073455zM139.636364 0h744.727272a139.636364 139.636364 0 0 1 139.636364 139.636364v744.727272a139.636364 139.636364 0 0 1-139.636364 139.636364H139.636364a139.636364 139.636364 0 0 1-139.636364-139.636364V139.636364a139.636364 139.636364 0 0 1 139.636364-139.636364z" p-id="3580"></path></svg>';
    defaultIcons["form-dropdown"] =
      '<svg width="24" height="24"><path d="M875.1104 327.68H148.8896A26.0096 26.0096 0 0 0 122.88 353.4848v337.3056A26.0096 26.0096 0 0 0 148.8896 716.8h726.2208A26.0096 26.0096 0 0 0 901.12 690.7904V353.4848A26.0096 26.0096 0 0 0 875.1104 327.68z m-25.8048 337.1008H174.6944V379.4944h674.6112z" p-id="6699"></path><path d="M652.9024 605.184a25.8048 25.8048 0 0 0 37.0688 0l99.9424-102.4a26.0096 26.0096 0 1 0-37.0688-36.2496l-81.92 83.1488-81.92-83.1488A26.0096 26.0096 0 0 0 552.96 502.9888z m0 0" p-id="6700"></path></svg>';
    defaultIcons["form-datepicker"] =
      '<svg width="24" height="24"><path d="M976.221 47.193h-207.04c0-23.477-18.992-42.469-42.469-42.469-23.473 0-42.471 18.992-42.471 42.469H344.482c0-23.477-18.995-42.469-42.47-42.469-23.474 0-42.469 18.992-42.469 42.469H52.502c-26.377 0-47.778 21.401-47.778 47.779v881.249c0 26.378 21.401 47.779 47.778 47.779h923.719c26.378 0 47.779-21.401 47.779-47.779V94.972c0-26.378-21.401-47.779-47.779-47.779m-16.653 915.375H66.125V344.482h893.444v618.086z m-20.507-660.556H89.664v-180.9h169.879v45.225c0 24.995 18.996 45.226 42.469 45.226 23.475 0 42.47-20.231 42.47-45.226v-45.225h339.759v45.225c0 24.995 18.998 45.226 42.471 45.226 23.477 0 42.469-20.231 42.469-45.226v-45.225h169.88v180.9z" p-id="7505"></path><path d="M353.602 418.999h-167.6v167.599h167.6V418.999z m-41.901 125.699h-83.799v-83.8h83.799v83.8zM605 418.999H437.401v167.599H605V418.999z m-41.898 125.699h-83.8v-83.8h83.8v83.8zM856.4 418.999H688.8v167.599h167.6V418.999z m-41.9 125.699h-83.799v-83.8H814.5v83.8zM353.602 670.398h-167.6v167.599h167.6V670.398z m-41.901 125.7h-83.799v-83.799h83.799v83.799zM605 670.398H437.401v167.599H605V670.398z m-41.898 125.7h-83.8v-83.799h83.8v83.799zM856.4 670.398H688.8v167.599h167.6V670.398z m-41.9 125.7h-83.799v-83.799H814.5v83.799z" p-id="7506"></path></svg>';
    defaultIcons["form-table"] =
      '<svg width="24" height="24"><path d="M246.6 152h372l-14 37.8h-358c-79.4 0-143.8 63.2-143.8 140.6v410.8c0 70.8 49.8 140.6 168 140.6V920H246.6C146.4 920 64 839.6 64 741V330.4C64 231.8 145.4 152 246.6 152z m458.2-112h133C550.2 796.2 546.4 837.8 468.4 918.6c-41.6 43.2-98.6 63.4-156.6 65.4v-102.2c98.4-15.4 129.2-99.8 129.2-150.6 0-40.2 1.2-25.2-164.2-446.4h122.8L500.4 598 704.8 40zM960 323V920H532c13.2-19.2 21.4-32.6 24.2-38.8h365V323c0-65-34.2-103.8-96.4-125.8l13.4-35.2c83.4 27.2 121.8 86.2 121.8 161z" p-id="14363"></path></svg>';
  }

  var register$1 = function (editor) {
    // 文本框
    editor.ui.registry.addButton("form-text", {
      icon: "form-text",
      tooltip: "普通文本",
      onAction: function (config) {
        new nomui.Modal({
          data: {},
          size: "middle",
          content: "/webapp/nomui-components/wetrial-editor-form/form-text.js",
          onClose: function (e) {
            if (e.result) {
              editor.execCommand(
                "mceInsertContent",
                false,
                '<input type="text" class="wetrial-editor-form-text" data-wetrial-type="form-text" />'
              );
            }
          },
        });
      },
    });

    // 文本框
    editor.ui.registry.addButton("form-textarea", {
      icon: "form-textarea",
      tooltip: "大文本",
      onAction: function (config) {
        // return open(editor);
        const openWindowManagerInstanc =
          tinymce.activeEditor.windowManager.openUrl({
            title: "配置大文本",
            url: "/webapp/public/demos/tinymce-demo.html",
            width: 600,
            height: 400,
            buttons: [
              {
                type: "cancel",
                text: "取消",
              },
              {
                type: "custom",
                text: "自定义",
              },
            ],
            onAction: function (dialogApi, details) {
              
            },
            onCancel: function (dialogApi) {
             
            },
            onClose: function () {
             
            },
            onMessage: function (dialogApi, details) {
              
            },
          });

        setTimeout(() => {
          openWindowManagerInstanc.sendMessage(
            {
              name: "xxg",
              id: "1111111111",
            },
            "*"
          );
        }, 1000);

        // editor.execCommand(
        //   "mceInsertContent",
        //   false,
        //   '<textarea lass="wetrial-editor-form-textarea" data-wetrial-type="form-textarea"></textarea>'
        // );
      },
    });

    // editor.ui.registry.addContextMenu("image", {
    //   update: function (element) {
    //     return !element.src ? "" : "image";
    //   },
    // });
  };

  function Plugin() {
    global.add("formdesigner", function (editor) {
      // register(editor, headState);
      registerIcons(editor);
      register$1(editor);
      // setup(editor, headState, footState);
    });
  }

  Plugin();
})();
